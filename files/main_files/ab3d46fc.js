!function(e){"use strict";var n={ldr_top:0,ldr_mid:0,ldr_low:0,vr_top:0,vr_low:0},o={storage:"sessionStorage"},t=function(o,t){function i(){var o=e.extend(n,JSON.parse(("sessionStorage"===l.params.storage&&"undefined"!=typeof window.sessionStorage?sessionStorage.getItem(g):e.cookie(g))||"{}"));o[l.params.code]++,"sessionStorage"===l.params.storage&&"undefined"!=typeof window.sessionStorage?sessionStorage.setItem(g,JSON.stringify(o)):e.cookie(g,JSON.stringify(o),{path:"/"})}function r(n){var t,i=e.Deferred(),r=!1;switch(n){case"viewport":r=Boolean(o.filter(":in-viewport").length);break;case"full":t=o.find("iframe").first(),r=Boolean("none"!==o.css("display")&&t.length&&t.height())}return r&&i.resolve()||i.reject(),i.promise()}function s(){c||(c=setTimeout(function(){r("viewport").done(function(){l.$window.off(["scroll.dfp_views_counter",l.params.code].join("_")),f()}),clearTimeout(c),c=null},p))}function a(){clearTimeout(c),c=null,l.$window.on(["scroll.dfp_views_counter",l.params.code].join("_"),s)}function f(){r("full").done(i).fail(function(){var e=0;d&&(d=!1,u=setInterval(function(){r("full").done(function(){r("viewport").done(i).fail(a),clearInterval(u),u=null}).fail(function(){++e>v&&(clearInterval(u),u=null)})},w))})}{var l=this,c=null,u=null,d=!0,p=50,w=300,v=10,g="dfp_views";!function(){l.$window=e(window),l.params=t,r("viewport").done(f).fail(a)}()}};t.prototype={destroy:function(){this.$window.off(["scroll.dfp_views_counter",this.params.code].join("_"))}},e.fn.dfpViewsCounter=function(i){return this.each(function(){var r=e(this),s=r.data("DfpViewsCounter");s&&"string"==typeof i?"function"==typeof s[i]&&s[i]():(i=e.extend({code:r.data("banner-code")},o),i.code in n&&r.data("DfpViewsCounter",new t(r,i)))})},e(function(){e(".dfp").dfpViewsCounter()})}(jQuery);